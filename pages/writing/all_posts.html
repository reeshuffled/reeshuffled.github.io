---
title: All Posts
layout: page
permalink: /posts/all/
---

<style>
    .list-group-flush > .list-group-item:first-child {
        padding-top: 0;
    }

    #searchresults.list-group .list-group-item:last-child {
        margin-bottom: 1em;
    }

    #searchresults {
        max-height: 1000px;
        overflow-y: scroll;
    }

    #btn-back-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: none;
    }
</style>

<!-- <p>
    My writing page is in the format of a <a href="https://maggieappleton.com/garden-history">digital garden</a> to
    serve as a collection of my thoughts, ideas, and opinions on various topics. Generally speaking, articles are the
    most polished version of my thoughts with notes being the less polished counterpart. Lists are just lists, sometimes
    I'll write rationale for items but other times it'll just be a plain and simple bulleted list. Stubs are not quite
    articles, lists, or notes; they're something in between. They are usually a grouping of related ideas/thoughts under
    a topic that is summarized by the title, the closest thing to it that I can think of is an article outline.
</p> -->

<form id="searchForm">
    <input type="search" id="searchInput" class="form-control" value="" placeholder="Search the garden...">
</form>

<ul id="searchResults" class="list-group"></ul>

<div class="row mb-2">
    <div class="col">
        <button id="clearFilters" class="btn btn-primary w-100 mt-2 d-none">
            Clear Filters (<span id="activeFilters"></span>)
        </button>
    </div>
</div>

<div class="row mb-2">
    <div class="col">
        <button id="randomPostBtn" class="btn btn-success w-100">ðŸŽ² Scroll To Random Post</button>
    </div>
</div>

<div id="card_grid" class="row row-cols-1 row-cols-md-3 g-2 mb-2"></div>

<button 
    id="btn-back-to-top"
    class="btn btn-success">
    Scroll to Top
</button>

<script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script>
<script src="https://unpkg.com/timeago.js/dist/timeago.min.js"></script>

{% 
    include_cached postSearching.html
    type='all_posts'
%}

<script>
    const cardGridEl = document.getElementById("card_grid");
    const clearFiltersBtn = document.getElementById("clearFilters");
    const activeFiltersListEl = document.getElementById("activeFilters");

    const globalFilters = {
        "types": [],
        "tags": []
    }

    // post data generated by Jekyll/Liquid
    const posts = [
        {% for post in site.posts %}
            {
                "title": `{{post.title}}`,
                "description": `{{post.description}}`,
                "url": "{{post.url}}",
                "type": "{{post.type}}",
                "date": new Date(
                    {{ post.date | date: '%Y' }},
                    {{ post.date | date: '%m' }} - 1,
                    {{ post.date | date: '%d' }}
                ),
                "tags": "{{ post.tags | join: ',' }}".split(",")
            },
        {% endfor %}
    ];

    (function initUI() {
        document.getElementById("randomPostBtn").onclick = () => {
            const cards = [...document.querySelectorAll("#card_grid .card")];
            cards[Math.floor(Math.random() * cards.length)].scrollIntoView();
        }

        clearFiltersBtn.onclick = clearFilters;

        bindScrollToTopActions();

        animateSearchPlaceholder();

        render();
    })();

    /**
     * Render the masonry layout of the garden post cards.
     */
    function render() {
        // clear
        cardGridEl.innerHTML = "";

        renderPostCards(
            posts
                .filter(post => globalFilters.types.length === 0 || globalFilters.types.includes(post.type))
                .filter(post => {
                    return (
                        globalFilters.tags.length === 0 || 
                        post.tags.filter(tag => globalFilters.tags.includes(tag)).length > 0
                    )
                })
                // sort DESC by post date
                .sort((a, b) => b.date - a.date)
        );

        // re-layout Masonry
        new Masonry(cardGridEl, {
            itemSelector: ".col",
            percentPosition: true
        });
    }

    /**
     * Render post cards.
     */
    function renderPostCards(items) {
        items
            .forEach(post => {
                // create card
                const card = createElement(
                    createElement(cardGridEl, "div", { class: "col" }),
                    "div",
                    { class: "card" }
                );
                
                const cardBody = createElement(card, "div", {
                    class: "card-body d-flex flex-column"
                });

                // create title link
                createElement(
                    createElement(
                        cardBody, 
                        "p", 
                        { 
                            class: "mb-1" 
                        }
                    ), 
                    "a", 
                    {
                        href: post.url,
                        text: post.title,
                    }
                );

                createElement(cardBody, "p", {
                    class: "mb-2",
                    text: post.description
                });

                const p = createElement(cardBody, "p", { class: "mb-0" });

                createElement(p, "span", {
                    class: "badge bg-secondary me-1",
                    text: titleCase(post.type),
                    title: `Only show ${post.type} posts`,
                    style: "cursor: pointer",
                    onclick: () => addFilter("types", post.type)
                });

                post.tags
                    .sort((a, b) => a.length - b.length)
                    .forEach(tag => {
                        createElement(p, "span", {
                            class: "badge bg-secondary me-1",
                            style: "cursor: pointer",
                            text: titleCase(tag),
                            title: `Only show ${tag} posts`,
                            onclick: () => addFilter("tags", tag)
                        });
                    });

                const footer = createElement(card, "div", { 
                    class: "card-footer",
                    text: `Published: ${timeago.format(post.date)}`
                });
            });
    }

    /**
     * Clear the global filters.
     */
    function clearFilters() {
        // clear all filters
        globalFilters.types = [];
        globalFilters.tags = [];

        // hide the clear filters button
        clearFiltersBtn.classList.add("d-none");

        // trigger re-render
        render();
    }

    /**
     * Add a global filter.
     */
    function addFilter(kind, filter) {
        // add global filter
        globalFilters[kind].push(filter);

        // show the clear filters button
        clearFiltersBtn.classList.remove("d-none");

        // populate the active filters list in the button
        activeFiltersListEl.innerText = globalFilters.types
            .concat(globalFilters.tags)
            .map(titleCase)
            .join(", ");

        // trigger a re-render
        render();
    }

    /**
     * Bind the scroll the top button functionality.
     * https://mdbootstrap.com/snippets/standard/mdbootstrap/2964350#js-tab-view
     */
    function bindScrollToTopActions() {
        const scrollToTopBtn = document.getElementById("btn-back-to-top");

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = () => {
            if (
                document.body.scrollTop > 20 ||
                document.documentElement.scrollTop > 20
            ) {
                scrollToTopBtn.style.display = "block";
            } else {
                scrollToTopBtn.style.display = "none";
            }
        }

        // When the user clicks on the button, scroll to the top of the document
        scrollToTopBtn.addEventListener("click", () => {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        });
    }

    /**
     * Animate the search input placeholder text.
     */
    function animateSearchPlaceholder() {
        const element = document.getElementById("searchInput");
        const text = "Search the garden";
        
        let dots = 0;
        setInterval(() => {
            // Cycle through 0, 1, 2, 3 dots
            dots = (dots + 1) % 4;

            element.placeholder = text + ".".repeat(dots);
        }, 1500);
    }

    /**
     * Capitalize the first letter of each word of a given string.
     */
    function titleCase(str) {
        return str
            .toLowerCase()
            .split(" ")
            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
            .join(" ");
    }

    /**
     * Create an HTML element and add it to the DOM tree.
     * @param {HTMLElement} parent 
     * @param {String} tag          
     * @param {Object} attributes 
     */
    function createElement(parent, tag, attributes = {}) {
        // create the element to whatever tag was given
        const el = document.createElement(tag);

        // go through all the attributes in the object that was given
        Object.entries(attributes)
            .forEach(([attr, value]) => {
                // handle the various special cases that will cause the Element to be malformed
                if (attr == "text") {
                    el.innerText = value;
                }
                else if (attr == "innerHTML") {
                    el.innerHTML = value;
                }
                else if (attr == "textContent") {
                    el.textContent = value;
                }
                else if (attr == "onclick") {
                    el.onclick = value;
                }
                else if (attr == "onkeydown") {
                    el.onkeydown = value;
                }
                else if (attr == "onchange") {
                    el.onchange = value;
                }
                else {
                    el.setAttribute(attr, value);
                }
            });

        // add the newly created element to its parent
        parent.appendChild(el);

        // return the element in case this element is a parent for later element creation
        return el;
    }
</script>